Remember for every malloc there needs to be a free, and the order of freeing elements matters.
